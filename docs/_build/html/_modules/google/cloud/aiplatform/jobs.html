

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>google.cloud.aiplatform.jobs &#8212; google-cloud-aiplatform  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
          	<div class="admonition" id="python2-eol"> 
          	 As of January 1, 2020 this library no longer supports Python 2 on the latest released version. 
          	 Library versions released prior to that date will continue to be available. For more information please
          	 visit <a href="https://cloud.google.com/python/docs/python2-sunset/">Python 2 support on Google Cloud</a>.
          	</div>
            
  <h1>Source code for google.cloud.aiplatform.jobs</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># Copyright 2020 Google LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">storage</span>
<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">bigquery</span>

<span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">credentials</span> <span class="k">as</span> <span class="n">auth_credentials</span>
<span class="kn">from</span> <span class="nn">google.protobuf</span> <span class="kn">import</span> <span class="n">duration_pb2</span>  <span class="c1"># type: ignore</span>

<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">aiplatform</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">base</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">compat</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">initializer</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">hyperparameter_tuning</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform.utils</span> <span class="kn">import</span> <span class="n">console_utils</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform.utils</span> <span class="kn">import</span> <span class="n">source_utils</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform.utils</span> <span class="kn">import</span> <span class="n">worker_spec_utils</span>

<span class="kn">from</span> <span class="nn">google.cloud.aiplatform.compat.services</span> <span class="kn">import</span> <span class="n">job_service_client</span>
<span class="kn">from</span> <span class="nn">google.cloud.aiplatform.compat.types</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">batch_prediction_job</span> <span class="k">as</span> <span class="n">gca_bp_job_compat</span><span class="p">,</span>
    <span class="n">batch_prediction_job_v1</span> <span class="k">as</span> <span class="n">gca_bp_job_v1</span><span class="p">,</span>
    <span class="n">batch_prediction_job_v1beta1</span> <span class="k">as</span> <span class="n">gca_bp_job_v1beta1</span><span class="p">,</span>
    <span class="n">custom_job</span> <span class="k">as</span> <span class="n">gca_custom_job_compat</span><span class="p">,</span>
    <span class="n">custom_job_v1beta1</span> <span class="k">as</span> <span class="n">gca_custom_job_v1beta1</span><span class="p">,</span>
    <span class="n">explanation_v1beta1</span> <span class="k">as</span> <span class="n">gca_explanation_v1beta1</span><span class="p">,</span>
    <span class="n">io</span> <span class="k">as</span> <span class="n">gca_io_compat</span><span class="p">,</span>
    <span class="n">io_v1beta1</span> <span class="k">as</span> <span class="n">gca_io_v1beta1</span><span class="p">,</span>
    <span class="n">job_state</span> <span class="k">as</span> <span class="n">gca_job_state</span><span class="p">,</span>
    <span class="n">hyperparameter_tuning_job</span> <span class="k">as</span> <span class="n">gca_hyperparameter_tuning_job_compat</span><span class="p">,</span>
    <span class="n">hyperparameter_tuning_job_v1beta1</span> <span class="k">as</span> <span class="n">gca_hyperparameter_tuning_job_v1beta1</span><span class="p">,</span>
    <span class="n">machine_resources</span> <span class="k">as</span> <span class="n">gca_machine_resources_compat</span><span class="p">,</span>
    <span class="n">machine_resources_v1beta1</span> <span class="k">as</span> <span class="n">gca_machine_resources_v1beta1</span><span class="p">,</span>
    <span class="n">study</span> <span class="k">as</span> <span class="n">gca_study_compat</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">_LOGGER</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_JOB_COMPLETE_STATES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_SUCCEEDED</span><span class="p">,</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_FAILED</span><span class="p">,</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_CANCELLED</span><span class="p">,</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_PAUSED</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">_JOB_ERROR_STATES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_FAILED</span><span class="p">,</span>
    <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_CANCELLED</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">_Job</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">VertexAiResourceNounWithFutureManager</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class that represents a general Job resource in Vertex AI.</span>
<span class="sd">    Cannot be directly instantiated.</span>

<span class="sd">    Serves as base class to specific Job types, i.e. BatchPredictionJob or</span>
<span class="sd">    DataLabelingJob to re-use shared functionality.</span>

<span class="sd">    Subclasses requires one class attribute:</span>

<span class="sd">    _getter_method (str): The name of JobServiceClient getter method for specific</span>
<span class="sd">    Job type, i.e. &#39;get_custom_job&#39; for CustomJob</span>
<span class="sd">    _cancel_method (str): The name of the specific JobServiceClient cancel method</span>
<span class="sd">    _delete_method (str): The name of the specific JobServiceClient delete method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">client_class</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">JobClientWithOverride</span>
    <span class="n">_is_client_prediction_client</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrives Job subclass resource by calling a subclass-specific getter</span>
<span class="sd">        method.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name (str):</span>
<span class="sd">                Required. A fully-qualified job resource name or job ID.</span>
<span class="sd">                Example: &quot;projects/123/locations/us-central1/batchPredictionJobs/456&quot; or</span>
<span class="sd">                &quot;456&quot; when project, location and job_type are initialized or passed.</span>
<span class="sd">            project: Optional[str] = None,</span>
<span class="sd">                Optional project to retrieve Job subclass from. If not set,</span>
<span class="sd">                project set in aiplatform.init will be used.</span>
<span class="sd">            location: Optional[str] = None,</span>
<span class="sd">                Optional location to retrieve Job subclass from. If not set,</span>
<span class="sd">                location set in aiplatform.init will be used.</span>
<span class="sd">            credentials: Optional[auth_credentials.Credentials] = None,</span>
<span class="sd">                Custom credentials to use. If not set, credentials set in</span>
<span class="sd">                aiplatform.init will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">job_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gca_resource</span><span class="p">(</span><span class="n">resource_name</span><span class="o">=</span><span class="n">job_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch Job again and return the current JobState.</span>

<span class="sd">        Returns:</span>
<span class="sd">            state (job_state.JobState):</span>
<span class="sd">                Enum that describes the state of a Vertex AI job.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Fetch the Job again for most up-to-date job state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_gca_resource</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">_job_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Job type.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">_cancel_method</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Name of cancellation method for cancelling the specific job type.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_dashboard_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Helper method to compose the dashboard uri where job can be</span>
<span class="sd">        viewed.&quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_fields_from_resource_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://console.cloud.google.com/ai/platform/locations/</span><span class="si">{</span><span class="n">fields</span><span class="o">.</span><span class="n">location</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_job_type</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">fields</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">?project=</span><span class="si">{</span><span class="n">fields</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">url</span>

    <span class="k">def</span> <span class="nf">_block_until_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper method to block and check on job until complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If job failed or cancelled.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Used these numbers so failures surface fast</span>
        <span class="n">wait</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># start at five seconds</span>
        <span class="n">log_wait</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">max_wait</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># 5 minute wait</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># scale wait by 2 every iteration</span>

        <span class="n">previous_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_JOB_COMPLETE_STATES</span><span class="p">:</span>
            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">previous_time</span> <span class="o">&gt;=</span> <span class="n">log_wait</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> current state:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">log_wait</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">log_wait</span> <span class="o">*</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">)</span>
                <span class="n">previous_time</span> <span class="o">=</span> <span class="n">current_time</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> current state:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Error is only populated when the job state is</span>
        <span class="c1"># JOB_STATE_FAILED or JOB_STATE_CANCELLED.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">state</span> <span class="ow">in</span> <span class="n">_JOB_ERROR_STATES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Job failed with:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_action_completed_against_resource</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="s2">&quot;completed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="nb">filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">VertexAiResourceNoun</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;List all instances of this Job Resource.</span>

<span class="sd">        Example Usage:</span>

<span class="sd">        aiplatform.BatchPredictionJobs.list(</span>
<span class="sd">            filter=&#39;state=&quot;JOB_STATE_SUCCEEDED&quot; AND display_name=&quot;my_job&quot;&#39;,</span>
<span class="sd">        )</span>

<span class="sd">        Args:</span>
<span class="sd">            filter (str):</span>
<span class="sd">                Optional. An expression for filtering the results of the request.</span>
<span class="sd">                For field names both snake_case and camelCase are supported.</span>
<span class="sd">            order_by (str):</span>
<span class="sd">                Optional. A comma-separated list of fields to order by, sorted in</span>
<span class="sd">                ascending order. Use &quot;desc&quot; after a field name for descending.</span>
<span class="sd">                Supported fields: `display_name`, `create_time`, `update_time`</span>
<span class="sd">            project (str):</span>
<span class="sd">                Optional. Project to retrieve list from. If not set, project</span>
<span class="sd">                set in aiplatform.init will be used.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Optional. Location to retrieve list from. If not set, location</span>
<span class="sd">                set in aiplatform.init will be used.</span>
<span class="sd">            credentials (auth_credentials.Credentials):</span>
<span class="sd">                Optional. Custom credentials to use to retrieve list. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[VertexAiResourceNoun] - A list of Job resource objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list_with_local_order</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cancels this Job.</span>

<span class="sd">        Success of cancellation is not guaranteed. Use `Job.state`</span>
<span class="sd">        property to verify if cancellation was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_action_start_against_resource</span><span class="p">(</span><span class="s2">&quot;Cancelling&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_client</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cancel_method</span><span class="p">)(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>


<div class="viewcode-block" id="BatchPredictionJob"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.BatchPredictionJob">[docs]</a><span class="k">class</span> <span class="nc">BatchPredictionJob</span><span class="p">(</span><span class="n">_Job</span><span class="p">):</span>

    <span class="n">_resource_noun</span> <span class="o">=</span> <span class="s2">&quot;batchPredictionJobs&quot;</span>
    <span class="n">_getter_method</span> <span class="o">=</span> <span class="s2">&quot;get_batch_prediction_job&quot;</span>
    <span class="n">_list_method</span> <span class="o">=</span> <span class="s2">&quot;list_batch_prediction_jobs&quot;</span>
    <span class="n">_cancel_method</span> <span class="o">=</span> <span class="s2">&quot;cancel_batch_prediction_job&quot;</span>
    <span class="n">_delete_method</span> <span class="o">=</span> <span class="s2">&quot;delete_batch_prediction_job&quot;</span>
    <span class="n">_job_type</span> <span class="o">=</span> <span class="s2">&quot;batch-predictions&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">batch_prediction_job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves a BatchPredictionJob resource and instantiates its</span>
<span class="sd">        representation.</span>

<span class="sd">        Args:</span>
<span class="sd">            batch_prediction_job_name (str):</span>
<span class="sd">                Required. A fully-qualified BatchPredictionJob resource name or ID.</span>
<span class="sd">                Example: &quot;projects/.../locations/.../batchPredictionJobs/456&quot; or</span>
<span class="sd">                &quot;456&quot; when project and location are initialized or passed.</span>
<span class="sd">            project: Optional[str] = None,</span>
<span class="sd">                Optional project to retrieve BatchPredictionJob from. If not set,</span>
<span class="sd">                project set in aiplatform.init will be used.</span>
<span class="sd">            location: Optional[str] = None,</span>
<span class="sd">                Optional location to retrieve BatchPredictionJob from. If not set,</span>
<span class="sd">                location set in aiplatform.init will be used.</span>
<span class="sd">            credentials: Optional[auth_credentials.Credentials] = None,</span>
<span class="sd">                Custom credentials to use. If not set, credentials set in</span>
<span class="sd">                aiplatform.init will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">job_name</span><span class="o">=</span><span class="n">batch_prediction_job_name</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="BatchPredictionJob.create"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.BatchPredictionJob.create">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">job_display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">instances_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;jsonl&quot;</span><span class="p">,</span>
        <span class="n">predictions_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;jsonl&quot;</span><span class="p">,</span>
        <span class="n">gcs_source</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bigquery_source</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gcs_destination_prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bigquery_destination_prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">machine_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">accelerator_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">accelerator_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">starting_replica_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_replica_count</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">generate_explanation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">explanation_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;aiplatform.explain.ExplanationMetadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">explanation_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="s2">&quot;aiplatform.explain.ExplanationParameters&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">encryption_spec_key_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BatchPredictionJob&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a batch prediction job.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_display_name (str):</span>
<span class="sd">                Required. The user-defined name of the BatchPredictionJob.</span>
<span class="sd">                The name can be up to 128 characters long and can be consist</span>
<span class="sd">                of any UTF-8 characters.</span>
<span class="sd">            model_name (str):</span>
<span class="sd">                Required. A fully-qualified model resource name or model ID.</span>
<span class="sd">                Example: &quot;projects/123/locations/us-central1/models/456&quot; or</span>
<span class="sd">                &quot;456&quot; when project and location are initialized or passed.</span>
<span class="sd">            instances_format (str):</span>
<span class="sd">                Required. The format in which instances are given, must be one</span>
<span class="sd">                of &quot;jsonl&quot;, &quot;csv&quot;, &quot;bigquery&quot;, &quot;tf-record&quot;, &quot;tf-record-gzip&quot;,</span>
<span class="sd">                or &quot;file-list&quot;. Default is &quot;jsonl&quot; when using `gcs_source`. If a</span>
<span class="sd">                `bigquery_source` is provided, this is overriden to &quot;bigquery&quot;.</span>
<span class="sd">            predictions_format (str):</span>
<span class="sd">                Required. The format in which Vertex AI gives the</span>
<span class="sd">                predictions, must be one of &quot;jsonl&quot;, &quot;csv&quot;, or &quot;bigquery&quot;.</span>
<span class="sd">                Default is &quot;jsonl&quot; when using `gcs_destination_prefix`. If a</span>
<span class="sd">                `bigquery_destination_prefix` is provided, this is overriden to</span>
<span class="sd">                &quot;bigquery&quot;.</span>
<span class="sd">            gcs_source (Optional[Sequence[str]]):</span>
<span class="sd">                Google Cloud Storage URI(-s) to your instances to run</span>
<span class="sd">                batch prediction on. They must match `instances_format`.</span>
<span class="sd">                May contain wildcards. For more information on wildcards, see</span>
<span class="sd">                https://cloud.google.com/storage/docs/gsutil/addlhelp/WildcardNames.</span>
<span class="sd">            bigquery_source (Optional[str]):</span>
<span class="sd">                BigQuery URI to a table, up to 2000 characters long. For example:</span>
<span class="sd">                `projectId.bqDatasetId.bqTableId`</span>
<span class="sd">            gcs_destination_prefix (Optional[str]):</span>
<span class="sd">                The Google Cloud Storage location of the directory where the</span>
<span class="sd">                output is to be written to. In the given directory a new</span>
<span class="sd">                directory is created. Its name is</span>
<span class="sd">                ``prediction-&lt;model-display-name&gt;-&lt;job-create-time&gt;``, where</span>
<span class="sd">                timestamp is in YYYY-MM-DDThh:mm:ss.sssZ ISO-8601 format.</span>
<span class="sd">                Inside of it files ``predictions_0001.&lt;extension&gt;``,</span>
<span class="sd">                ``predictions_0002.&lt;extension&gt;``, ...,</span>
<span class="sd">                ``predictions_N.&lt;extension&gt;`` are created where</span>
<span class="sd">                ``&lt;extension&gt;`` depends on chosen ``predictions_format``,</span>
<span class="sd">                and N may equal 0001 and depends on the total number of</span>
<span class="sd">                successfully predicted instances. If the Model has both</span>
<span class="sd">                ``instance`` and ``prediction`` schemata defined then each such</span>
<span class="sd">                file contains predictions as per the ``predictions_format``.</span>
<span class="sd">                If prediction for any instance failed (partially or</span>
<span class="sd">                completely), then an additional ``errors_0001.&lt;extension&gt;``,</span>
<span class="sd">                ``errors_0002.&lt;extension&gt;``,..., ``errors_N.&lt;extension&gt;``</span>
<span class="sd">                files are created (N depends on total number of failed</span>
<span class="sd">                predictions). These files contain the failed instances, as</span>
<span class="sd">                per their schema, followed by an additional ``error`` field</span>
<span class="sd">                which as value has ```google.rpc.Status`` &lt;Status&gt;`__</span>
<span class="sd">                containing only ``code`` and ``message`` fields.</span>
<span class="sd">            bigquery_destination_prefix (Optional[str]):</span>
<span class="sd">                The BigQuery project location where the output is to be</span>
<span class="sd">                written to. In the given project a new dataset is created</span>
<span class="sd">                with name</span>
<span class="sd">                ``prediction_&lt;model-display-name&gt;_&lt;job-create-time&gt;`` where</span>
<span class="sd">                is made BigQuery-dataset-name compatible (for example, most</span>
<span class="sd">                special characters become underscores), and timestamp is in</span>
<span class="sd">                YYYY_MM_DDThh_mm_ss_sssZ &quot;based on ISO-8601&quot; format. In the</span>
<span class="sd">                dataset two tables will be created, ``predictions``, and</span>
<span class="sd">                ``errors``. If the Model has both ``instance`` and ``prediction``</span>
<span class="sd">                schemata defined then the tables have columns as follows:</span>
<span class="sd">                The ``predictions`` table contains instances for which the</span>
<span class="sd">                prediction succeeded, it has columns as per a concatenation</span>
<span class="sd">                of the Model&#39;s instance and prediction schemata. The</span>
<span class="sd">                ``errors`` table contains rows for which the prediction has</span>
<span class="sd">                failed, it has instance columns, as per the instance schema,</span>
<span class="sd">                followed by a single &quot;errors&quot; column, which as values has</span>
<span class="sd">                ```google.rpc.Status`` &lt;Status&gt;`__ represented as a STRUCT,</span>
<span class="sd">                and containing only ``code`` and ``message``.</span>
<span class="sd">            model_parameters (Optional[Dict]):</span>
<span class="sd">                The parameters that govern the predictions. The schema of</span>
<span class="sd">                the parameters may be specified via the Model&#39;s `parameters_schema_uri`.</span>
<span class="sd">            machine_type (Optional[str]):</span>
<span class="sd">                The type of machine for running batch prediction on</span>
<span class="sd">                dedicated resources. Not specifying machine type will result in</span>
<span class="sd">                batch prediction job being run with automatic resources.</span>
<span class="sd">            accelerator_type (Optional[str]):</span>
<span class="sd">                The type of accelerator(s) that may be attached</span>
<span class="sd">                to the machine as per `accelerator_count`. Only used if</span>
<span class="sd">                `machine_type` is set.</span>
<span class="sd">            accelerator_count (Optional[int]):</span>
<span class="sd">                The number of accelerators to attach to the</span>
<span class="sd">                `machine_type`. Only used if `machine_type` is set.</span>
<span class="sd">            starting_replica_count (Optional[int]):</span>
<span class="sd">                The number of machine replicas used at the start of the batch</span>
<span class="sd">                operation. If not set, Vertex AI decides starting number, not</span>
<span class="sd">                greater than `max_replica_count`. Only used if `machine_type` is</span>
<span class="sd">                set.</span>
<span class="sd">            max_replica_count (Optional[int]):</span>
<span class="sd">                The maximum number of machine replicas the batch operation may</span>
<span class="sd">                be scaled to. Only used if `machine_type` is set.</span>
<span class="sd">                Default is 10.</span>
<span class="sd">            generate_explanation (bool):</span>
<span class="sd">                Optional. Generate explanation along with the batch prediction</span>
<span class="sd">                results. This will cause the batch prediction output to include</span>
<span class="sd">                explanations based on the `prediction_format`:</span>
<span class="sd">                    - `bigquery`: output includes a column named `explanation`. The value</span>
<span class="sd">                        is a struct that conforms to the [aiplatform.gapic.Explanation] object.</span>
<span class="sd">                    - `jsonl`: The JSON objects on each line include an additional entry</span>
<span class="sd">                        keyed `explanation`. The value of the entry is a JSON object that</span>
<span class="sd">                        conforms to the [aiplatform.gapic.Explanation] object.</span>
<span class="sd">                    - `csv`: Generating explanations for CSV format is not supported.</span>
<span class="sd">            explanation_metadata (aiplatform.explain.ExplanationMetadata):</span>
<span class="sd">                Optional. Explanation metadata configuration for this BatchPredictionJob.</span>
<span class="sd">                Can be specified only if `generate_explanation` is set to `True`.</span>

<span class="sd">                This value overrides the value of `Model.explanation_metadata`.</span>
<span class="sd">                All fields of `explanation_metadata` are optional in the request. If</span>
<span class="sd">                a field of the `explanation_metadata` object is not populated, the</span>
<span class="sd">                corresponding field of the `Model.explanation_metadata` object is inherited.</span>
<span class="sd">                For more details, see `Ref docs &lt;http://tinyurl.com/1igh60kt&gt;`</span>
<span class="sd">            explanation_parameters (aiplatform.explain.ExplanationParameters):</span>
<span class="sd">                Optional. Parameters to configure explaining for Model&#39;s predictions.</span>
<span class="sd">                Can be specified only if `generate_explanation` is set to `True`.</span>

<span class="sd">                This value overrides the value of `Model.explanation_parameters`.</span>
<span class="sd">                All fields of `explanation_parameters` are optional in the request. If</span>
<span class="sd">                a field of the `explanation_parameters` object is not populated, the</span>
<span class="sd">                corresponding field of the `Model.explanation_parameters` object is inherited.</span>
<span class="sd">                For more details, see `Ref docs &lt;http://tinyurl.com/1an4zake&gt;`</span>
<span class="sd">            labels (Optional[dict]):</span>
<span class="sd">                The labels with user-defined metadata to organize your</span>
<span class="sd">                BatchPredictionJobs. Label keys and values can be no longer than</span>
<span class="sd">                64 characters (Unicode codepoints), can only contain lowercase</span>
<span class="sd">                letters, numeric characters, underscores and dashes.</span>
<span class="sd">                International characters are allowed. See https://goo.gl/xmQnxf</span>
<span class="sd">                for more information and examples of labels.</span>
<span class="sd">            credentials (Optional[auth_credentials.Credentials]):</span>
<span class="sd">                Custom credentials to use to create this batch prediction</span>
<span class="sd">                job. Overrides credentials set in aiplatform.init.</span>
<span class="sd">            encryption_spec_key_name (Optional[str]):</span>
<span class="sd">                Optional. The Cloud KMS resource identifier of the customer</span>
<span class="sd">                managed encryption key used to protect the job. Has the</span>
<span class="sd">                form:</span>
<span class="sd">                ``projects/my-project/locations/my-region/keyRings/my-kr/cryptoKeys/my-key``.</span>
<span class="sd">                The key needs to be in the same region as where the compute</span>
<span class="sd">                resource is created.</span>

<span class="sd">                If this is set, then all</span>
<span class="sd">                resources created by the BatchPredictionJob will</span>
<span class="sd">                be encrypted with the provided encryption key.</span>

<span class="sd">                Overrides encryption_spec_key_name set in aiplatform.init.</span>
<span class="sd">            sync (bool):</span>
<span class="sd">                Whether to execute this method synchronously. If False, this method</span>
<span class="sd">                will be executed in concurrent Future and any downstream object will</span>
<span class="sd">                be immediately returned and synced when the Future has completed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jobs.BatchPredictionJob):</span>
<span class="sd">                Instantiated representation of the created batch prediction job.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">utils</span><span class="o">.</span><span class="n">validate_display_name</span><span class="p">(</span><span class="n">job_display_name</span><span class="p">)</span>

        <span class="n">model_name</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">full_resource_name</span><span class="p">(</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">resource_noun</span><span class="o">=</span><span class="s2">&quot;models&quot;</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Raise error if both or neither source URIs are provided</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">gcs_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bigquery_source</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please provide either a gcs_source or bigquery_source, &quot;</span>
                <span class="s2">&quot;but not both.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Raise error if both or neither destination prefixes are provided</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">gcs_destination_prefix</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bigquery_destination_prefix</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please provide either a gcs_destination_prefix or &quot;</span>
                <span class="s2">&quot;bigquery_destination_prefix, but not both.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Raise error if unsupported instance format is provided</span>
        <span class="k">if</span> <span class="n">instances_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">BATCH_PREDICTION_INPUT_STORAGE_FORMATS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">predictions_format</span><span class="si">}</span><span class="s2"> is not an accepted instances format &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;type. Please choose from: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">BATCH_PREDICTION_INPUT_STORAGE_FORMATS</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Raise error if unsupported prediction format is provided</span>
        <span class="k">if</span> <span class="n">predictions_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">BATCH_PREDICTION_OUTPUT_STORAGE_FORMATS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">predictions_format</span><span class="si">}</span><span class="s2"> is not an accepted prediction format &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;type. Please choose from: </span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">BATCH_PREDICTION_OUTPUT_STORAGE_FORMATS</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">gca_bp_job</span> <span class="o">=</span> <span class="n">gca_bp_job_compat</span>
        <span class="n">gca_io</span> <span class="o">=</span> <span class="n">gca_io_compat</span>
        <span class="n">gca_machine_resources</span> <span class="o">=</span> <span class="n">gca_machine_resources_compat</span>
        <span class="n">select_version</span> <span class="o">=</span> <span class="n">compat</span><span class="o">.</span><span class="n">DEFAULT_VERSION</span>
        <span class="k">if</span> <span class="n">generate_explanation</span><span class="p">:</span>
            <span class="n">gca_bp_job</span> <span class="o">=</span> <span class="n">gca_bp_job_v1beta1</span>
            <span class="n">gca_io</span> <span class="o">=</span> <span class="n">gca_io_v1beta1</span>
            <span class="n">gca_machine_resources</span> <span class="o">=</span> <span class="n">gca_machine_resources_v1beta1</span>
            <span class="n">select_version</span> <span class="o">=</span> <span class="n">compat</span><span class="o">.</span><span class="n">V1BETA1</span>

        <span class="n">gapic_batch_prediction_job</span> <span class="o">=</span> <span class="n">gca_bp_job</span><span class="o">.</span><span class="n">BatchPredictionJob</span><span class="p">()</span>

        <span class="c1"># Required Fields</span>
        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">job_display_name</span>
        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_name</span>

        <span class="n">input_config</span> <span class="o">=</span> <span class="n">gca_bp_job</span><span class="o">.</span><span class="n">BatchPredictionJob</span><span class="o">.</span><span class="n">InputConfig</span><span class="p">()</span>
        <span class="n">output_config</span> <span class="o">=</span> <span class="n">gca_bp_job</span><span class="o">.</span><span class="n">BatchPredictionJob</span><span class="o">.</span><span class="n">OutputConfig</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">bigquery_source</span><span class="p">:</span>
            <span class="n">input_config</span><span class="o">.</span><span class="n">instances_format</span> <span class="o">=</span> <span class="s2">&quot;bigquery&quot;</span>
            <span class="n">input_config</span><span class="o">.</span><span class="n">bigquery_source</span> <span class="o">=</span> <span class="n">gca_io</span><span class="o">.</span><span class="n">BigQuerySource</span><span class="p">()</span>
            <span class="n">input_config</span><span class="o">.</span><span class="n">bigquery_source</span><span class="o">.</span><span class="n">input_uri</span> <span class="o">=</span> <span class="n">bigquery_source</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">input_config</span><span class="o">.</span><span class="n">instances_format</span> <span class="o">=</span> <span class="n">instances_format</span>
            <span class="n">input_config</span><span class="o">.</span><span class="n">gcs_source</span> <span class="o">=</span> <span class="n">gca_io</span><span class="o">.</span><span class="n">GcsSource</span><span class="p">(</span>
                <span class="n">uris</span><span class="o">=</span><span class="n">gcs_source</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">gcs_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="k">else</span> <span class="p">[</span><span class="n">gcs_source</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">bigquery_destination_prefix</span><span class="p">:</span>
            <span class="n">output_config</span><span class="o">.</span><span class="n">predictions_format</span> <span class="o">=</span> <span class="s2">&quot;bigquery&quot;</span>
            <span class="n">output_config</span><span class="o">.</span><span class="n">bigquery_destination</span> <span class="o">=</span> <span class="n">gca_io</span><span class="o">.</span><span class="n">BigQueryDestination</span><span class="p">()</span>

            <span class="n">bq_dest_prefix</span> <span class="o">=</span> <span class="n">bigquery_destination_prefix</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">bq_dest_prefix</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bq://&quot;</span><span class="p">):</span>
                <span class="n">bq_dest_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;bq://</span><span class="si">{</span><span class="n">bq_dest_prefix</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">output_config</span><span class="o">.</span><span class="n">bigquery_destination</span><span class="o">.</span><span class="n">output_uri</span> <span class="o">=</span> <span class="n">bq_dest_prefix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_config</span><span class="o">.</span><span class="n">predictions_format</span> <span class="o">=</span> <span class="n">predictions_format</span>
            <span class="n">output_config</span><span class="o">.</span><span class="n">gcs_destination</span> <span class="o">=</span> <span class="n">gca_io</span><span class="o">.</span><span class="n">GcsDestination</span><span class="p">(</span>
                <span class="n">output_uri_prefix</span><span class="o">=</span><span class="n">gcs_destination_prefix</span>
            <span class="p">)</span>

        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">input_config</span> <span class="o">=</span> <span class="n">input_config</span>
        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="n">output_config</span>

        <span class="c1"># Optional Fields</span>
        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">encryption_spec</span> <span class="o">=</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">get_encryption_spec</span><span class="p">(</span>
            <span class="n">encryption_spec_key_name</span><span class="o">=</span><span class="n">encryption_spec_key_name</span><span class="p">,</span>
            <span class="n">select_version</span><span class="o">=</span><span class="n">select_version</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">model_parameters</span><span class="p">:</span>
            <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">model_parameters</span> <span class="o">=</span> <span class="n">model_parameters</span>

        <span class="c1"># Custom Compute</span>
        <span class="k">if</span> <span class="n">machine_type</span><span class="p">:</span>

            <span class="n">machine_spec</span> <span class="o">=</span> <span class="n">gca_machine_resources</span><span class="o">.</span><span class="n">MachineSpec</span><span class="p">()</span>
            <span class="n">machine_spec</span><span class="o">.</span><span class="n">machine_type</span> <span class="o">=</span> <span class="n">machine_type</span>
            <span class="n">machine_spec</span><span class="o">.</span><span class="n">accelerator_type</span> <span class="o">=</span> <span class="n">accelerator_type</span>
            <span class="n">machine_spec</span><span class="o">.</span><span class="n">accelerator_count</span> <span class="o">=</span> <span class="n">accelerator_count</span>

            <span class="n">dedicated_resources</span> <span class="o">=</span> <span class="n">gca_machine_resources</span><span class="o">.</span><span class="n">BatchDedicatedResources</span><span class="p">()</span>

            <span class="n">dedicated_resources</span><span class="o">.</span><span class="n">machine_spec</span> <span class="o">=</span> <span class="n">machine_spec</span>
            <span class="n">dedicated_resources</span><span class="o">.</span><span class="n">starting_replica_count</span> <span class="o">=</span> <span class="n">starting_replica_count</span>
            <span class="n">dedicated_resources</span><span class="o">.</span><span class="n">max_replica_count</span> <span class="o">=</span> <span class="n">max_replica_count</span>

            <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">dedicated_resources</span> <span class="o">=</span> <span class="n">dedicated_resources</span>

            <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">manual_batch_tuning_parameters</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># User Labels</span>
        <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>

        <span class="c1"># Explanations</span>
        <span class="k">if</span> <span class="n">generate_explanation</span><span class="p">:</span>
            <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">generate_explanation</span> <span class="o">=</span> <span class="n">generate_explanation</span>

        <span class="k">if</span> <span class="n">explanation_metadata</span> <span class="ow">or</span> <span class="n">explanation_parameters</span><span class="p">:</span>
            <span class="n">gapic_batch_prediction_job</span><span class="o">.</span><span class="n">explanation_spec</span> <span class="o">=</span> <span class="n">gca_explanation_v1beta1</span><span class="o">.</span><span class="n">ExplanationSpec</span><span class="p">(</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">explanation_metadata</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">explanation_parameters</span>
            <span class="p">)</span>

        <span class="c1"># TODO (b/174502913): Support private feature once released</span>

        <span class="n">api_client</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instantiate_client</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_create</span><span class="p">(</span>
            <span class="n">api_client</span><span class="o">=</span><span class="n">api_client</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">common_location_path</span><span class="p">(</span>
                <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span>
            <span class="p">),</span>
            <span class="n">batch_prediction_job</span><span class="o">=</span><span class="n">gapic_batch_prediction_job</span><span class="p">,</span>
            <span class="n">generate_explanation</span><span class="o">=</span><span class="n">generate_explanation</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
            <span class="n">sync</span><span class="o">=</span><span class="n">sync</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="nd">@base</span><span class="o">.</span><span class="n">optional_sync</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_create</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">api_client</span><span class="p">:</span> <span class="n">job_service_client</span><span class="o">.</span><span class="n">JobServiceClient</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">batch_prediction_job</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="n">gca_bp_job_v1beta1</span><span class="o">.</span><span class="n">BatchPredictionJob</span><span class="p">,</span> <span class="n">gca_bp_job_v1</span><span class="o">.</span><span class="n">BatchPredictionJob</span>
        <span class="p">],</span>
        <span class="n">generate_explanation</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">],</span>
        <span class="n">sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BatchPredictionJob&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a batch prediction job.</span>

<span class="sd">        Args:</span>
<span class="sd">            api_client (dataset_service_client.DatasetServiceClient):</span>
<span class="sd">                Required. An instance of DatasetServiceClient with the correct api_endpoint</span>
<span class="sd">                already set based on user&#39;s preferences.</span>
<span class="sd">            batch_prediction_job (gca_bp_job.BatchPredictionJob):</span>
<span class="sd">                Required. a batch prediction job proto for creating a batch prediction job on Vertex AI.</span>
<span class="sd">            generate_explanation (bool):</span>
<span class="sd">                Required. Generate explanation along with the batch prediction</span>
<span class="sd">                results.</span>
<span class="sd">            parent (str):</span>
<span class="sd">                Required. Also known as common location path, that usually contains the</span>
<span class="sd">                project and location that the user provided to the upstream method.</span>
<span class="sd">                Example: &quot;projects/my-prj/locations/us-central1&quot;</span>
<span class="sd">            project (str):</span>
<span class="sd">                Required. Project to upload this model to. Overrides project set in</span>
<span class="sd">                aiplatform.init.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Required. Location to upload this model to. Overrides location set in</span>
<span class="sd">                aiplatform.init.</span>
<span class="sd">            credentials (Optional[auth_credentials.Credentials]):</span>
<span class="sd">                Custom credentials to use to upload this model. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jobs.BatchPredictionJob):</span>
<span class="sd">                Instantiated representation of the created batch prediction job.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError:</span>
<span class="sd">                If no or multiple source or destinations are provided. Also, if</span>
<span class="sd">                provided instances_format or predictions_format are not supported</span>
<span class="sd">                by Vertex AI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># select v1beta1 if explain else use default v1</span>
        <span class="k">if</span> <span class="n">generate_explanation</span><span class="p">:</span>
            <span class="n">api_client</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">select_version</span><span class="p">(</span><span class="n">compat</span><span class="o">.</span><span class="n">V1BETA1</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_with_lro</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

        <span class="n">gca_batch_prediction_job</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_batch_prediction_job</span><span class="p">(</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">batch_prediction_job</span><span class="o">=</span><span class="n">batch_prediction_job</span>
        <span class="p">)</span>

        <span class="n">batch_prediction_job</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">batch_prediction_job_name</span><span class="o">=</span><span class="n">gca_batch_prediction_job</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_complete</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">batch_prediction_job</span><span class="o">.</span><span class="n">_gca_resource</span><span class="p">,</span> <span class="s2">&quot;bpj&quot;</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;View Batch Prediction Job:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">batch_prediction_job</span><span class="o">.</span><span class="n">_dashboard_uri</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">batch_prediction_job</span><span class="o">.</span><span class="n">_block_until_complete</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">batch_prediction_job</span>

<div class="viewcode-block" id="BatchPredictionJob.iter_outputs"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.BatchPredictionJob.iter_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">iter_outputs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bq_max_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">storage</span><span class="o">.</span><span class="n">Blob</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">bigquery</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">RowIterator</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Returns an Iterable object to traverse the output files, either a</span>
<span class="sd">        list of GCS Blobs or a BigQuery RowIterator depending on the output</span>
<span class="sd">        config set when the BatchPredictionJob was created.</span>

<span class="sd">        Args:</span>
<span class="sd">            bq_max_results: Optional[int] = 100</span>
<span class="sd">                Limit on rows to retrieve from prediction table in BigQuery dataset.</span>
<span class="sd">                Only used when retrieving predictions from a bigquery_destination_prefix.</span>
<span class="sd">                Default is 100.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[Iterable[storage.Blob], Iterable[bigquery.table.RowIterator]]:</span>
<span class="sd">                Either a list of GCS Blob objects within the prediction output</span>
<span class="sd">                directory or an iterable BigQuery RowIterator with predictions.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError:</span>
<span class="sd">                If BatchPredictionJob is in a JobState other than SUCCEEDED,</span>
<span class="sd">                since outputs cannot be retrieved until the Job has finished.</span>
<span class="sd">            NotImplementedError:</span>
<span class="sd">                If BatchPredictionJob succeeded and output_info does not have a</span>
<span class="sd">                GCS or BQ output provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">JOB_STATE_SUCCEEDED</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot read outputs until BatchPredictionJob has succeeded, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;current state: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">output_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">output_info</span>

        <span class="c1"># GCS Destination, return Blobs</span>
        <span class="k">if</span> <span class="n">output_info</span><span class="o">.</span><span class="n">gcs_output_directory</span><span class="p">:</span>

            <span class="c1"># Build a Storage Client using the same credentials as JobServiceClient</span>
            <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
                <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
                <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">_transport</span><span class="o">.</span><span class="n">_credentials</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">gcs_bucket</span><span class="p">,</span> <span class="n">gcs_prefix</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_bucket_and_prefix_from_gcs_path</span><span class="p">(</span>
                <span class="n">output_info</span><span class="o">.</span><span class="n">gcs_output_directory</span>
            <span class="p">)</span>

            <span class="n">blobs</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">list_blobs</span><span class="p">(</span><span class="n">gcs_bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">gcs_prefix</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">blobs</span>

        <span class="c1"># BigQuery Destination, return RowIterator</span>
        <span class="k">elif</span> <span class="n">output_info</span><span class="o">.</span><span class="n">bigquery_output_dataset</span><span class="p">:</span>

            <span class="c1"># Build a BigQuery Client using the same credentials as JobServiceClient</span>
            <span class="n">bq_client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
                <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
                <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">_transport</span><span class="o">.</span><span class="n">_credentials</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Format from service is `bq://projectId.bqDatasetId`</span>
            <span class="n">bq_dataset</span> <span class="o">=</span> <span class="n">output_info</span><span class="o">.</span><span class="n">bigquery_output_dataset</span>

            <span class="k">if</span> <span class="n">bq_dataset</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bq://&quot;</span><span class="p">):</span>
                <span class="n">bq_dataset</span> <span class="o">=</span> <span class="n">bq_dataset</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>

            <span class="c1"># # Split project ID and BQ dataset ID</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">bq_dataset_id</span> <span class="o">=</span> <span class="n">bq_dataset</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">row_iterator</span> <span class="o">=</span> <span class="n">bq_client</span><span class="o">.</span><span class="n">list_rows</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bq_dataset_id</span><span class="si">}</span><span class="s2">.predictions&quot;</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="n">bq_max_results</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="n">row_iterator</span>

        <span class="c1"># Unknown Destination type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported batch prediction output location, here are details&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;on your prediction output:</span><span class="se">\n</span><span class="si">{</span><span class="n">output_info</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_RunnableJob</span><span class="p">(</span><span class="n">_Job</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ABC to interface job as a runnable training class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes job with project, location, and api_client.</span>

<span class="sd">        Args:</span>
<span class="sd">            project(str): Project of the resource noun.</span>
<span class="sd">            location(str): The location of the resource noun.</span>
<span class="sd">            credentials(google.auth.crendentials.Crendentials): Optional custom</span>
<span class="sd">                credentials to use when accessing interacting with resource noun.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">base</span><span class="o">.</span><span class="n">VertexAiResourceNounWithFutureManager</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">aiplatform</span><span class="o">.</span><span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">common_location_path</span><span class="p">(</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span>
        <span class="p">)</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_has_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Property returns true if this class has a resource name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gca_job_state</span><span class="o">.</span><span class="n">JobState</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Current state of job.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError if job run has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_run</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Job has not run. No state available.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">resource_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;_RunnableJob&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get an Vertex AI Job for the given resource_name.</span>

<span class="sd">        Args:</span>
<span class="sd">            resource_name (str):</span>
<span class="sd">                Required. A fully-qualified resource name or ID.</span>
<span class="sd">            project (str):</span>
<span class="sd">                Optional project to retrieve dataset from. If not set, project</span>
<span class="sd">                set in aiplatform.init will be used.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Optional location to retrieve dataset from. If not set, location</span>
<span class="sd">                set in aiplatform.init will be used.</span>
<span class="sd">            credentials (auth_credentials.Credentials):</span>
<span class="sd">                Custom credentials to use to upload this model. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An Vertex AI Job.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_empty_constructor</span><span class="p">(</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">resource_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gca_resource</span><span class="p">(</span><span class="n">resource_name</span><span class="o">=</span><span class="n">resource_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">DataLabelingJob</span><span class="p">(</span><span class="n">_Job</span><span class="p">):</span>
    <span class="n">_resource_noun</span> <span class="o">=</span> <span class="s2">&quot;dataLabelingJobs&quot;</span>
    <span class="n">_getter_method</span> <span class="o">=</span> <span class="s2">&quot;get_data_labeling_job&quot;</span>
    <span class="n">_list_method</span> <span class="o">=</span> <span class="s2">&quot;list_data_labeling_jobs&quot;</span>
    <span class="n">_cancel_method</span> <span class="o">=</span> <span class="s2">&quot;cancel_data_labeling_job&quot;</span>
    <span class="n">_delete_method</span> <span class="o">=</span> <span class="s2">&quot;delete_data_labeling_job&quot;</span>
    <span class="n">_job_type</span> <span class="o">=</span> <span class="s2">&quot;labeling-tasks&quot;</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="CustomJob"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.CustomJob">[docs]</a><span class="k">class</span> <span class="nc">CustomJob</span><span class="p">(</span><span class="n">_RunnableJob</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Vertex AI Custom Job.&quot;&quot;&quot;</span>

    <span class="n">_resource_noun</span> <span class="o">=</span> <span class="s2">&quot;customJobs&quot;</span>
    <span class="n">_getter_method</span> <span class="o">=</span> <span class="s2">&quot;get_custom_job&quot;</span>
    <span class="n">_list_method</span> <span class="o">=</span> <span class="s2">&quot;list_custom_job&quot;</span>
    <span class="n">_cancel_method</span> <span class="o">=</span> <span class="s2">&quot;cancel_custom_job&quot;</span>
    <span class="n">_delete_method</span> <span class="o">=</span> <span class="s2">&quot;delete_custom_job&quot;</span>
    <span class="n">_job_type</span> <span class="o">=</span> <span class="s2">&quot;training&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">worker_pool_specs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">aiplatform</span><span class="o">.</span><span class="n">gapic</span><span class="o">.</span><span class="n">WorkerPoolSpec</span><span class="p">]],</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">encryption_spec_key_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">staging_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cosntruct a Custom Job with Worker Pool Specs.</span>

<span class="sd">        ```</span>
<span class="sd">        Example usage:</span>
<span class="sd">        worker_pool_specs = [</span>
<span class="sd">                {</span>
<span class="sd">                    &quot;machine_spec&quot;: {</span>
<span class="sd">                        &quot;machine_type&quot;: &quot;n1-standard-4&quot;,</span>
<span class="sd">                        &quot;accelerator_type&quot;: &quot;NVIDIA_TESLA_K80&quot;,</span>
<span class="sd">                        &quot;accelerator_count&quot;: 1,</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;replica_count&quot;: 1,</span>
<span class="sd">                    &quot;container_spec&quot;: {</span>
<span class="sd">                        &quot;image_uri&quot;: container_image_uri,</span>
<span class="sd">                        &quot;command&quot;: [],</span>
<span class="sd">                        &quot;args&quot;: [],</span>
<span class="sd">                    },</span>
<span class="sd">                }</span>
<span class="sd">            ]</span>

<span class="sd">        my_job = aiplatform.CustomJob(</span>
<span class="sd">            display_name=&#39;my_job&#39;,</span>
<span class="sd">            worker_pool_specs=worker_pool_specs</span>
<span class="sd">        )</span>

<span class="sd">        my_job.run()</span>
<span class="sd">        ```</span>


<span class="sd">        For more information on configuring worker pool specs please visit:</span>
<span class="sd">        https://cloud.google.com/ai-platform-unified/docs/training/create-custom-job</span>


<span class="sd">        Args:</span>
<span class="sd">            display_name (str):</span>
<span class="sd">                Required. The user-defined name of the HyperparameterTuningJob.</span>
<span class="sd">                The name can be up to 128 characters long and can be consist</span>
<span class="sd">                of any UTF-8 characters.</span>
<span class="sd">            worker_pool_specs (Union[List[Dict], List[aiplatform.gapic.WorkerPoolSpec]]):</span>
<span class="sd">                Required. The spec of the worker pools including machine type and Docker image.</span>
<span class="sd">                Can provided as a list of dictionaries or list of WorkerPoolSpec proto messages.</span>
<span class="sd">            project (str):</span>
<span class="sd">                Optional.Project to run the custom job in. Overrides project set in aiplatform.init.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Optional.Location to run the custom job in. Overrides location set in aiplatform.init.</span>
<span class="sd">            credentials (auth_credentials.Credentials):</span>
<span class="sd">                Optional.Custom credentials to use to run call custom job service. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>
<span class="sd">            encryption_spec_key_name (str):</span>
<span class="sd">                Optional.Customer-managed encryption key name for a</span>
<span class="sd">                CustomJob. If this is set, then all resources</span>
<span class="sd">                created by the CustomJob will be encrypted with</span>
<span class="sd">                the provided encryption key.</span>
<span class="sd">            staging_bucket (str):</span>
<span class="sd">                Optional. Bucket for produced custom job artifacts. Overrides</span>
<span class="sd">                staging_bucket set in aiplatform.init.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError is not staging bucket was set using aiplatfrom.init and a staging</span>
<span class="sd">            bucket was not passed in.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

        <span class="n">staging_bucket</span> <span class="o">=</span> <span class="n">staging_bucket</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">staging_bucket</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">staging_bucket</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;staging_bucket should be passed to CustomJob constructor or &quot;</span>
                <span class="s2">&quot;should be set using aiplatform.init(staging_bucket=&#39;gs://my-bucket&#39;)&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="n">gca_custom_job_compat</span><span class="o">.</span><span class="n">CustomJob</span><span class="p">(</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">display_name</span><span class="p">,</span>
            <span class="n">job_spec</span><span class="o">=</span><span class="n">gca_custom_job_compat</span><span class="o">.</span><span class="n">CustomJobSpec</span><span class="p">(</span>
                <span class="n">worker_pool_specs</span><span class="o">=</span><span class="n">worker_pool_specs</span><span class="p">,</span>
                <span class="n">base_output_directory</span><span class="o">=</span><span class="n">gca_io_compat</span><span class="o">.</span><span class="n">GcsDestination</span><span class="p">(</span>
                    <span class="n">output_uri_prefix</span><span class="o">=</span><span class="n">staging_bucket</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">encryption_spec</span><span class="o">=</span><span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">get_encryption_spec</span><span class="p">(</span>
                <span class="n">encryption_spec_key_name</span><span class="o">=</span><span class="n">encryption_spec_key_name</span>
            <span class="p">),</span>
        <span class="p">)</span>

<div class="viewcode-block" id="CustomJob.from_local_script"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.CustomJob.from_local_script">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_local_script</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">script_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">container_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">environment_variables</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">replica_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">machine_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;n1-standard-4&quot;</span><span class="p">,</span>
        <span class="n">accelerator_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ACCELERATOR_TYPE_UNSPECIFIED&quot;</span><span class="p">,</span>
        <span class="n">accelerator_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">encryption_spec_key_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">staging_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CustomJob&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Configures a custom job from a local script.</span>

<span class="sd">        Example usage:</span>
<span class="sd">        ```</span>
<span class="sd">        job = aiplatform.CustomJob.from_local_script(</span>
<span class="sd">            display_name=&quot;my-custom-job&quot;,</span>
<span class="sd">            script_path=&quot;training_script.py&quot;,</span>
<span class="sd">            container_uri=&quot;gcr.io/cloud-aiplatform/training/tf-cpu.2-2:latest&quot;,</span>
<span class="sd">            requirements=[&quot;gcsfs==0.7.1&quot;],</span>
<span class="sd">            replica_count=1,</span>
<span class="sd">            args=[&#39;--dataset&#39;, &#39;gs://my-bucket/my-dataset&#39;,</span>
<span class="sd">            &#39;--model_output_uri&#39;, &#39;gs://my-bucket/model&#39;]</span>
<span class="sd">        )</span>

<span class="sd">        job.run()</span>
<span class="sd">        ```</span>

<span class="sd">        Args:</span>
<span class="sd">            display_name (str):</span>
<span class="sd">                Required. The user-defined name of this CustomJob.</span>
<span class="sd">            script_path (str):</span>
<span class="sd">                Required. Local path to training script.</span>
<span class="sd">            container_uri (str):</span>
<span class="sd">                Required: Uri of the training container image to use for custom job.</span>
<span class="sd">            args (Optional[List[Union[str, float, int]]]):</span>
<span class="sd">                Optional. Command line arguments to be passed to the Python task.</span>
<span class="sd">            requirements (Sequence[str]):</span>
<span class="sd">                Optional. List of python packages dependencies of script.</span>
<span class="sd">            environment_variables (Dict[str, str]):</span>
<span class="sd">                Optional. Environment variables to be passed to the container.</span>
<span class="sd">                Should be a dictionary where keys are environment variable names</span>
<span class="sd">                and values are environment variable values for those names.</span>
<span class="sd">                At most 10 environment variables can be specified.</span>
<span class="sd">                The Name of the environment variable must be unique.</span>

<span class="sd">                environment_variables = {</span>
<span class="sd">                    &#39;MY_KEY&#39;: &#39;MY_VALUE&#39;</span>
<span class="sd">                }</span>
<span class="sd">            replica_count (int):</span>
<span class="sd">                Optional. The number of worker replicas. If replica count = 1 then one chief</span>
<span class="sd">                replica will be provisioned. If replica_count &gt; 1 the remainder will be</span>
<span class="sd">                provisioned as a worker replica pool.</span>
<span class="sd">            machine_type (str):</span>
<span class="sd">                Optional. The type of machine to use for training.</span>
<span class="sd">            accelerator_type (str):</span>
<span class="sd">                Optional. Hardware accelerator type. One of ACCELERATOR_TYPE_UNSPECIFIED,</span>
<span class="sd">                NVIDIA_TESLA_K80, NVIDIA_TESLA_P100, NVIDIA_TESLA_V100, NVIDIA_TESLA_P4,</span>
<span class="sd">                NVIDIA_TESLA_T4</span>
<span class="sd">            accelerator_count (int):</span>
<span class="sd">                Optional. The number of accelerators to attach to a worker replica.</span>
<span class="sd">            project (str):</span>
<span class="sd">                Optional. Project to run the custom job in. Overrides project set in aiplatform.init.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Optional. Location to run the custom job in. Overrides location set in aiplatform.init.</span>
<span class="sd">            credentials (auth_credentials.Credentials):</span>
<span class="sd">                Optional. Custom credentials to use to run call custom job service. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>
<span class="sd">            encryption_spec_key_name (str):</span>
<span class="sd">                Optional. Customer-managed encryption key name for a</span>
<span class="sd">                CustomJob. If this is set, then all resources</span>
<span class="sd">                created by the CustomJob will be encrypted with</span>
<span class="sd">                the provided encryption key.</span>
<span class="sd">            staging_bucket (str):</span>
<span class="sd">                Optional. Bucket for produced custom job artifacts. Overrides</span>
<span class="sd">                staging_bucket set in aiplatform.init.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError is not staging bucket was set using aiplatfrom.init and a staging</span>
<span class="sd">            bucket was not passed in.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">project</span> <span class="o">=</span> <span class="n">project</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">project</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">location</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">location</span>
        <span class="n">staging_bucket</span> <span class="o">=</span> <span class="n">staging_bucket</span> <span class="ow">or</span> <span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">staging_bucket</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">staging_bucket</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;staging_bucket should be passed to CustomJob.from_local_script or &quot;</span>
                <span class="s2">&quot;should be set using aiplatform.init(staging_bucket=&#39;gs://my-bucket&#39;)&quot;</span>
            <span class="p">)</span>

        <span class="n">worker_pool_specs</span> <span class="o">=</span> <span class="n">worker_spec_utils</span><span class="o">.</span><span class="n">_DistributedTrainingSpec</span><span class="o">.</span><span class="n">chief_worker_pool</span><span class="p">(</span>
            <span class="n">replica_count</span><span class="o">=</span><span class="n">replica_count</span><span class="p">,</span>
            <span class="n">machine_type</span><span class="o">=</span><span class="n">machine_type</span><span class="p">,</span>
            <span class="n">accelerator_count</span><span class="o">=</span><span class="n">accelerator_count</span><span class="p">,</span>
            <span class="n">accelerator_type</span><span class="o">=</span><span class="n">accelerator_type</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">pool_specs</span>

        <span class="n">python_packager</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">_TrainingScriptPythonPackager</span><span class="p">(</span>
            <span class="n">script_path</span><span class="o">=</span><span class="n">script_path</span><span class="p">,</span> <span class="n">requirements</span><span class="o">=</span><span class="n">requirements</span>
        <span class="p">)</span>

        <span class="n">package_gcs_uri</span> <span class="o">=</span> <span class="n">python_packager</span><span class="o">.</span><span class="n">package_and_copy_to_gcs</span><span class="p">(</span>
            <span class="n">gcs_staging_dir</span><span class="o">=</span><span class="n">staging_bucket</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">worker_pool_specs</span><span class="p">:</span>
            <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;python_package_spec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;executor_image_uri&quot;</span><span class="p">:</span> <span class="n">container_uri</span><span class="p">,</span>
                <span class="s2">&quot;python_module&quot;</span><span class="p">:</span> <span class="n">python_packager</span><span class="o">.</span><span class="n">module_name</span><span class="p">,</span>
                <span class="s2">&quot;package_uris&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">package_gcs_uri</span><span class="p">],</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
                <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;python_package_spec&quot;</span><span class="p">][</span><span class="s2">&quot;args&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span>

            <span class="k">if</span> <span class="n">environment_variables</span><span class="p">:</span>
                <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;python_package_spec&quot;</span><span class="p">][</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">environment_variables</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">display_name</span><span class="p">,</span>
            <span class="n">worker_pool_specs</span><span class="o">=</span><span class="n">worker_pool_specs</span><span class="p">,</span>
            <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
            <span class="n">encryption_spec_key_name</span><span class="o">=</span><span class="n">encryption_spec_key_name</span><span class="p">,</span>
            <span class="n">staging_bucket</span><span class="o">=</span><span class="n">staging_bucket</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CustomJob.run"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.CustomJob.run">[docs]</a>    <span class="nd">@base</span><span class="o">.</span><span class="n">optional_sync</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">service_account</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">network</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">restart_job_on_worker_restart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tensorboard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run this configured CustomJob.</span>

<span class="sd">        Args:</span>
<span class="sd">            service_account (str):</span>
<span class="sd">                Optional. Specifies the service account for workload run-as account.</span>
<span class="sd">                Users submitting jobs must have act-as permission on this run-as account.</span>
<span class="sd">            network (str):</span>
<span class="sd">                Optional. The full name of the Compute Engine network to which the job</span>
<span class="sd">                should be peered. For example, projects/12345/global/networks/myVPC.</span>
<span class="sd">                Private services access must already be configured for the network.</span>
<span class="sd">                If left unspecified, the job is not peered with any network.</span>
<span class="sd">            timeout (int):</span>
<span class="sd">                The maximum job running time in seconds. The default is 7 days.</span>
<span class="sd">            restart_job_on_worker_restart (bool):</span>
<span class="sd">                Restarts the entire CustomJob if a worker</span>
<span class="sd">                gets restarted. This feature can be used by</span>
<span class="sd">                distributed training jobs that are not resilient</span>
<span class="sd">                to workers leaving and joining a job.</span>
<span class="sd">            tensorboard (str):</span>
<span class="sd">                Optional. The name of an Vertex AI</span>
<span class="sd">                [Tensorboard][google.cloud.aiplatform.v1beta1.Tensorboard]</span>
<span class="sd">                resource to which this CustomJob will upload Tensorboard</span>
<span class="sd">                logs. Format:</span>
<span class="sd">                ``projects/{project}/locations/{location}/tensorboards/{tensorboard}``</span>

<span class="sd">                The training script should write Tensorboard to following Vertex AI environment</span>
<span class="sd">                variable:</span>

<span class="sd">                AIP_TENSORBOARD_LOG_DIR</span>

<span class="sd">                `service_account` is required with provided `tensorboard`.</span>
<span class="sd">                For more information on configuring your service account please visit:</span>
<span class="sd">                https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-training</span>
<span class="sd">            sync (bool):</span>
<span class="sd">                Whether to execute this method synchronously. If False, this method</span>
<span class="sd">                will unblock and it will be executed in a concurrent Future.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">service_account</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">job_spec</span><span class="o">.</span><span class="n">service_account</span> <span class="o">=</span> <span class="n">service_account</span>

        <span class="k">if</span> <span class="n">network</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">job_spec</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span>

        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">or</span> <span class="n">restart_job_on_worker_restart</span><span class="p">:</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="n">duration_pb2</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">job_spec</span><span class="o">.</span><span class="n">scheduling</span> <span class="o">=</span> <span class="n">gca_custom_job_compat</span><span class="o">.</span><span class="n">Scheduling</span><span class="p">(</span>
                <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
                <span class="n">restart_job_on_worker_restart</span><span class="o">=</span><span class="n">restart_job_on_worker_restart</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">tensorboard</span><span class="p">:</span>
            <span class="n">v1beta1_gca_resource</span> <span class="o">=</span> <span class="n">gca_custom_job_v1beta1</span><span class="o">.</span><span class="n">CustomJob</span><span class="p">()</span>
            <span class="n">v1beta1_gca_resource</span><span class="o">.</span><span class="n">_pb</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">_pb</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="n">v1beta1_gca_resource</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">job_spec</span><span class="o">.</span><span class="n">tensorboard</span> <span class="o">=</span> <span class="n">tensorboard</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_with_lro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>

        <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;v1beta1&quot;</span> <span class="k">if</span> <span class="n">tensorboard</span> <span class="k">else</span> <span class="s2">&quot;v1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">select_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span><span class="o">.</span><span class="n">create_custom_job</span><span class="p">(</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">,</span> <span class="n">custom_job</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span>
        <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_complete_with_getter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="p">,</span> <span class="s2">&quot;custom_job&quot;</span>
        <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;View Custom Job:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashboard_uri</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">tensorboard</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;View Tensorboard:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">console_utils</span><span class="o">.</span><span class="n">custom_job_tensorboard_console_uri</span><span class="p">(</span>
                    <span class="n">tensorboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_name</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_block_until_complete</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">job_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">job_spec</span></div>


<span class="n">_SEARCH_ALGORITHM_TO_PROTO_VALUE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">Algorithm</span><span class="o">.</span><span class="n">RANDOM_SEARCH</span><span class="p">,</span>
    <span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">Algorithm</span><span class="o">.</span><span class="n">GRID_SEARCH</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">:</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">Algorithm</span><span class="o">.</span><span class="n">ALGORITHM_UNSPECIFIED</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">_MEASUREMENT_SELECTION_TO_PROTO_VALUE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;best&quot;</span><span class="p">:</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">MeasurementSelectionType</span><span class="o">.</span><span class="n">BEST_MEASUREMENT</span><span class="p">,</span>
    <span class="s2">&quot;last&quot;</span><span class="p">:</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">MeasurementSelectionType</span><span class="o">.</span><span class="n">LAST_MEASUREMENT</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="HyperparameterTuningJob"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.HyperparameterTuningJob">[docs]</a><span class="k">class</span> <span class="nc">HyperparameterTuningJob</span><span class="p">(</span><span class="n">_RunnableJob</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Vertex AI Hyperparameter Tuning Job.&quot;&quot;&quot;</span>

    <span class="n">_resource_noun</span> <span class="o">=</span> <span class="s2">&quot;hyperparameterTuningJobs&quot;</span>
    <span class="n">_getter_method</span> <span class="o">=</span> <span class="s2">&quot;get_hyperparameter_tuning_job&quot;</span>
    <span class="n">_list_method</span> <span class="o">=</span> <span class="s2">&quot;list_hyperparameter_tuning_jobs&quot;</span>
    <span class="n">_cancel_method</span> <span class="o">=</span> <span class="s2">&quot;cancel_hyperparameter_tuning_job&quot;</span>
    <span class="n">_delete_method</span> <span class="o">=</span> <span class="s2">&quot;delete_hyperparameter_tuning_job&quot;</span>
    <span class="n">_job_type</span> <span class="o">=</span> <span class="s2">&quot;training&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">display_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">custom_job</span><span class="p">:</span> <span class="n">CustomJob</span><span class="p">,</span>
        <span class="n">metric_spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">parameter_spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hyperparameter_tuning</span><span class="o">.</span><span class="n">_ParameterSpec</span><span class="p">],</span>
        <span class="n">max_trial_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">parallel_trial_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">max_failed_trial_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">measurement_selection</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">auth_credentials</span><span class="o">.</span><span class="n">Credentials</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">encryption_spec_key_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures a HyperparameterTuning Job.</span>

<span class="sd">        Example usage:</span>

<span class="sd">        ```</span>
<span class="sd">        from google.cloud.aiplatform import hyperparameter_tuning as hpt</span>

<span class="sd">        worker_pool_specs = [</span>
<span class="sd">                {</span>
<span class="sd">                    &quot;machine_spec&quot;: {</span>
<span class="sd">                        &quot;machine_type&quot;: &quot;n1-standard-4&quot;,</span>
<span class="sd">                        &quot;accelerator_type&quot;: &quot;NVIDIA_TESLA_K80&quot;,</span>
<span class="sd">                        &quot;accelerator_count&quot;: 1,</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;replica_count&quot;: 1,</span>
<span class="sd">                    &quot;container_spec&quot;: {</span>
<span class="sd">                        &quot;image_uri&quot;: container_image_uri,</span>
<span class="sd">                        &quot;command&quot;: [],</span>
<span class="sd">                        &quot;args&quot;: [],</span>
<span class="sd">                    },</span>
<span class="sd">                }</span>
<span class="sd">            ]</span>

<span class="sd">        custom_job = aiplatform.CustomJob(</span>
<span class="sd">            display_name=&#39;my_job&#39;,</span>
<span class="sd">            worker_pool_specs=worker_pool_specs</span>
<span class="sd">        )</span>


<span class="sd">        hp_job = aiplatform.HyperparameterTuningJob(</span>
<span class="sd">            display_name=&#39;hp-test&#39;,</span>
<span class="sd">            custom_job=job,</span>
<span class="sd">            metric_spec={</span>
<span class="sd">                &#39;loss&#39;: &#39;minimize&#39;,</span>
<span class="sd">            },</span>
<span class="sd">            parameter_spec={</span>
<span class="sd">                &#39;lr&#39;: hpt.DoubleParameterSpec(min=0.001, max=0.1, scale=&#39;log&#39;),</span>
<span class="sd">                &#39;units&#39;: hpt.IntegerParameterSpec(min=4, max=128, scale=&#39;linear&#39;),</span>
<span class="sd">                &#39;activation&#39;: hpt.CategoricalParameterSpec(values=[&#39;relu&#39;, &#39;selu&#39;]),</span>
<span class="sd">                &#39;batch_size&#39;: hpt.DiscreteParameterSpec(values=[128, 256], scale=&#39;linear&#39;)</span>
<span class="sd">            },</span>
<span class="sd">            max_trial_count=128,</span>
<span class="sd">            parallel_trial_count=8,</span>
<span class="sd">            )</span>

<span class="sd">        hp_job.run()</span>

<span class="sd">        print(hp_job.trials)</span>
<span class="sd">        ```</span>


<span class="sd">        For more information on using hyperparameter tuning please visit:</span>
<span class="sd">        https://cloud.google.com/ai-platform-unified/docs/training/using-hyperparameter-tuning</span>

<span class="sd">        Args:</span>
<span class="sd">            display_name (str):</span>
<span class="sd">                Required. The user-defined name of the HyperparameterTuningJob.</span>
<span class="sd">                The name can be up to 128 characters long and can be consist</span>
<span class="sd">                of any UTF-8 characters.</span>
<span class="sd">            custom_job (aiplatform.CustomJob):</span>
<span class="sd">                Required. Configured CustomJob. The worker pool spec from this custom job</span>
<span class="sd">                applies to the CustomJobs created in all the trials.</span>
<span class="sd">            metric_spec: Dict[str, str]</span>
<span class="sd">                Required. Dicionary representing metrics to optimize. The dictionary key is the metric_id,</span>
<span class="sd">                which is reported by your training job, and the dictionary value is the</span>
<span class="sd">                optimization goal of the metric(&#39;minimize&#39; or &#39;maximize&#39;). example:</span>

<span class="sd">                metric_spec = {&#39;loss&#39;: &#39;minimize&#39;, &#39;accuracy&#39;: &#39;maximize&#39;}</span>

<span class="sd">            parameter_spec (Dict[str, hyperparameter_tuning._ParameterSpec]):</span>
<span class="sd">                Required. Dictionary representing parameters to optimize. The dictionary key is the metric_id,</span>
<span class="sd">                which is passed into your training job as a command line key word arguemnt, and the</span>
<span class="sd">                dictionary value is the parameter specification of the metric.</span>


<span class="sd">                from google.cloud.aiplatform import hyperparameter_tuning as hpt</span>

<span class="sd">                parameter_spec={</span>
<span class="sd">                    &#39;decay&#39;: hpt.DoubleParameterSpec(min=1e-7, max=1, scale=&#39;linear&#39;),</span>
<span class="sd">                    &#39;learning_rate&#39;: hpt.DoubleParameterSpec(min=1e-7, max=1, scale=&#39;linear&#39;)</span>
<span class="sd">                    &#39;batch_size&#39;: hpt.DiscreteParamterSpec(values=[4, 8, 16, 32, 64, 128], scale=&#39;linear&#39;)</span>
<span class="sd">                }</span>

<span class="sd">                Supported parameter specifications can be found until aiplatform.hyperparameter_tuning.</span>
<span class="sd">                These parameter specification are currently supported:</span>
<span class="sd">                DoubleParameterSpec, IntegerParameterSpec, CategoricalParameterSpace, DiscreteParameterSpec</span>

<span class="sd">            max_trial_count (int):</span>
<span class="sd">                Reuired. The desired total number of Trials.</span>
<span class="sd">            parallel_trial_count (int):</span>
<span class="sd">                Required. The desired number of Trials to run in parallel.</span>
<span class="sd">            max_failed_trial_count (int):</span>
<span class="sd">                Optional. The number of failed Trials that need to be</span>
<span class="sd">                seen before failing the HyperparameterTuningJob.</span>
<span class="sd">                If set to 0, Vertex AI decides how many Trials</span>
<span class="sd">                must fail before the whole job fails.</span>
<span class="sd">            search_algorithm (str):</span>
<span class="sd">                The search algorithm specified for the Study.</span>
<span class="sd">                Accepts one of the following:</span>
<span class="sd">                    `None` - If you do not specify an algorithm, your job uses</span>
<span class="sd">                    the default Vertex AI algorithm. The default algorithm</span>
<span class="sd">                    applies Bayesian optimization to arrive at the optimal</span>
<span class="sd">                    solution with a more effective search over the parameter space.</span>

<span class="sd">                    &#39;grid&#39; - A simple grid search within the feasible space. This</span>
<span class="sd">                    option is particularly useful if you want to specify a quantity</span>
<span class="sd">                    of trials that is greater than the number of points in the</span>
<span class="sd">                    feasible space. In such cases, if you do not specify a grid</span>
<span class="sd">                    search, the Vertex AI default algorithm may generate duplicate</span>
<span class="sd">                    suggestions. To use grid search, all parameter specs must be</span>
<span class="sd">                    of type `IntegerParameterSpec`, `CategoricalParameterSpace`,</span>
<span class="sd">                    or `DiscreteParameterSpec`.</span>

<span class="sd">                    &#39;random&#39; - A simple random search within the feasible space.</span>
<span class="sd">            measurement_selection (str):</span>
<span class="sd">                This indicates which measurement to use if/when the service</span>
<span class="sd">                automatically selects the final measurement from previously reported</span>
<span class="sd">                intermediate measurements.</span>

<span class="sd">                Accepts: &#39;best&#39;, &#39;last&#39;</span>

<span class="sd">                Choose this based on two considerations:</span>
<span class="sd">                A) Do you expect your measurements to monotonically improve? If so,</span>
<span class="sd">                choose &#39;last&#39;. On the other hand, if you&#39;re in a situation</span>
<span class="sd">                where your system can &quot;over-train&quot; and you expect the performance to</span>
<span class="sd">                get better for a while but then start declining, choose</span>
<span class="sd">                &#39;best&#39;. B) Are your measurements significantly noisy</span>
<span class="sd">                and/or irreproducible? If so, &#39;best&#39; will tend to be</span>
<span class="sd">                over-optimistic, and it may be better to choose &#39;last&#39;. If</span>
<span class="sd">                both or neither of (A) and (B) apply, it doesn&#39;t matter which</span>
<span class="sd">                selection type is chosen.</span>
<span class="sd">            project (str):</span>
<span class="sd">                Optional. Project to run the HyperparameterTuningjob in. Overrides project set in aiplatform.init.</span>
<span class="sd">            location (str):</span>
<span class="sd">                Optional. Location to run the HyperparameterTuning in. Overrides location set in aiplatform.init.</span>
<span class="sd">            credentials (auth_credentials.Credentials):</span>
<span class="sd">                Optional. Custom credentials to use to run call HyperparameterTuning service. Overrides</span>
<span class="sd">                credentials set in aiplatform.init.</span>
<span class="sd">            encryption_spec_key_name (str):</span>
<span class="sd">                Optional. Customer-managed encryption key options for a</span>
<span class="sd">                HyperparameterTuningJob. If this is set, then</span>
<span class="sd">                all resources created by the</span>
<span class="sd">                HyperparameterTuningJob will be encrypted with</span>
<span class="sd">                the provided encryption key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="o">.</span><span class="n">MetricSpec</span><span class="p">(</span>
                <span class="n">metric_id</span><span class="o">=</span><span class="n">metric_id</span><span class="p">,</span> <span class="n">goal</span><span class="o">=</span><span class="n">goal</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">metric_id</span><span class="p">,</span> <span class="n">goal</span> <span class="ow">in</span> <span class="n">metric_spec</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">_to_parameter_spec</span><span class="p">(</span><span class="n">parameter_id</span><span class="o">=</span><span class="n">parameter_id</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">parameter_id</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameter_spec</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="n">study_spec</span> <span class="o">=</span> <span class="n">gca_study_compat</span><span class="o">.</span><span class="n">StudySpec</span><span class="p">(</span>
            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">algorithm</span><span class="o">=</span><span class="n">_SEARCH_ALGORITHM_TO_PROTO_VALUE</span><span class="p">[</span><span class="n">search_algorithm</span><span class="p">],</span>
            <span class="n">measurement_selection_type</span><span class="o">=</span><span class="n">_MEASUREMENT_SELECTION_TO_PROTO_VALUE</span><span class="p">[</span>
                <span class="n">measurement_selection</span>
            <span class="p">],</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="n">gca_hyperparameter_tuning_job_compat</span><span class="o">.</span><span class="n">HyperparameterTuningJob</span><span class="p">(</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">display_name</span><span class="p">,</span>
            <span class="n">study_spec</span><span class="o">=</span><span class="n">study_spec</span><span class="p">,</span>
            <span class="n">max_trial_count</span><span class="o">=</span><span class="n">max_trial_count</span><span class="p">,</span>
            <span class="n">parallel_trial_count</span><span class="o">=</span><span class="n">parallel_trial_count</span><span class="p">,</span>
            <span class="n">max_failed_trial_count</span><span class="o">=</span><span class="n">max_failed_trial_count</span><span class="p">,</span>
            <span class="n">trial_job_spec</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">custom_job</span><span class="o">.</span><span class="n">job_spec</span><span class="p">),</span>
            <span class="n">encryption_spec</span><span class="o">=</span><span class="n">initializer</span><span class="o">.</span><span class="n">global_config</span><span class="o">.</span><span class="n">get_encryption_spec</span><span class="p">(</span>
                <span class="n">encryption_spec_key_name</span><span class="o">=</span><span class="n">encryption_spec_key_name</span>
            <span class="p">),</span>
        <span class="p">)</span>

<div class="viewcode-block" id="HyperparameterTuningJob.run"><a class="viewcode-back" href="../../../../aiplatform.html#google.cloud.aiplatform.HyperparameterTuningJob.run">[docs]</a>    <span class="nd">@base</span><span class="o">.</span><span class="n">optional_sync</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">service_account</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">network</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># seconds</span>
        <span class="n">restart_job_on_worker_restart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tensorboard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run this configured CustomJob.</span>

<span class="sd">        Args:</span>
<span class="sd">            service_account (str):</span>
<span class="sd">                Optional. Specifies the service account for workload run-as account.</span>
<span class="sd">                Users submitting jobs must have act-as permission on this run-as account.</span>
<span class="sd">            network (str):</span>
<span class="sd">                Optional. The full name of the Compute Engine network to which the job</span>
<span class="sd">                should be peered. For example, projects/12345/global/networks/myVPC.</span>
<span class="sd">                Private services access must already be configured for the network.</span>
<span class="sd">                If left unspecified, the job is not peered with any network.</span>
<span class="sd">            timeout (int):</span>
<span class="sd">                Optional. The maximum job running time in seconds. The default is 7 days.</span>
<span class="sd">            restart_job_on_worker_restart (bool):</span>
<span class="sd">                Restarts the entire CustomJob if a worker</span>
<span class="sd">                gets restarted. This feature can be used by</span>
<span class="sd">                distributed training jobs that are not resilient</span>
<span class="sd">                to workers leaving and joining a job.</span>
<span class="sd">            tensorboard (str):</span>
<span class="sd">                Optional. The name of an Vertex AI</span>
<span class="sd">                [Tensorboard][google.cloud.aiplatform.v1beta1.Tensorboard]</span>
<span class="sd">                resource to which this CustomJob will upload Tensorboard</span>
<span class="sd">                logs. Format:</span>
<span class="sd">                ``projects/{project}/locations/{location}/tensorboards/{tensorboard}``</span>

<span class="sd">                The training script should write Tensorboard to following Vertex AI environment</span>
<span class="sd">                variable:</span>

<span class="sd">                AIP_TENSORBOARD_LOG_DIR</span>

<span class="sd">                `service_account` is required with provided `tensorboard`.</span>
<span class="sd">                For more information on configuring your service account please visit:</span>
<span class="sd">                https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-training</span>
<span class="sd">            sync (bool):</span>
<span class="sd">                Whether to execute this method synchronously. If False, this method</span>
<span class="sd">                will unblock and it will be executed in a concurrent Future.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">service_account</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">trial_job_spec</span><span class="o">.</span><span class="n">service_account</span> <span class="o">=</span> <span class="n">service_account</span>

        <span class="k">if</span> <span class="n">network</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">trial_job_spec</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span>

        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">or</span> <span class="n">restart_job_on_worker_restart</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">duration_pb2</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">trial_job_spec</span><span class="o">.</span><span class="n">scheduling</span> <span class="o">=</span> <span class="n">gca_custom_job_compat</span><span class="o">.</span><span class="n">Scheduling</span><span class="p">(</span>
                <span class="n">timeout</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
                <span class="n">restart_job_on_worker_restart</span><span class="o">=</span><span class="n">restart_job_on_worker_restart</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">tensorboard</span><span class="p">:</span>
            <span class="n">v1beta1_gca_resource</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">gca_hyperparameter_tuning_job_v1beta1</span><span class="o">.</span><span class="n">HyperparameterTuningJob</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">v1beta1_gca_resource</span><span class="o">.</span><span class="n">_pb</span><span class="o">.</span><span class="n">MergeFromString</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">_pb</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="n">v1beta1_gca_resource</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">trial_job_spec</span><span class="o">.</span><span class="n">tensorboard</span> <span class="o">=</span> <span class="n">tensorboard</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_with_lro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>

        <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;v1beta1&quot;</span> <span class="k">if</span> <span class="n">tensorboard</span> <span class="k">else</span> <span class="s2">&quot;v1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_client</span><span class="o">.</span><span class="n">select_version</span><span class="p">(</span>
            <span class="n">version</span>
        <span class="p">)</span><span class="o">.</span><span class="n">create_hyperparameter_tuning_job</span><span class="p">(</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">,</span> <span class="n">hyperparameter_tuning_job</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span>
        <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">log_create_complete_with_getter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="p">,</span> <span class="s2">&quot;hpt_job&quot;</span>
        <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;View HyperparameterTuningJob:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dashboard_uri</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">tensorboard</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;View Tensorboard:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">console_utils</span><span class="o">.</span><span class="n">custom_job_tensorboard_console_uri</span><span class="p">(</span>
                    <span class="n">tensorboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_name</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_block_until_complete</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">gca_study_compat</span><span class="o">.</span><span class="n">Trial</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gca_resource</span><span class="o">.</span><span class="n">trials</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">google-cloud-aiplatform</a></h1>



<p class="blurb">Google Cloud Client Libraries for google-cloud-aiplatform</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=googleapis&repo=python-aiplatform&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../aiplatform.html">Google Cloud Aiplatform SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../aiplatform_v1/services.html">Services for Google Cloud Aiplatform v1 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../aiplatform_v1/types.html">Types for Google Cloud Aiplatform v1 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../aiplatform_v1beta1/services.html">Services for Google Cloud Aiplatform v1beta1 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../aiplatform_v1beta1/types.html">Types for Google Cloud Aiplatform v1beta1 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Google.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    
    <a href="https://github.com/googleapis/python-aiplatform" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>